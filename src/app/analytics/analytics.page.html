<ion-header>
  <ion-toolbar>
    <ion-title>Analytics</ion-title>
    <ion-buttons slot="start">
      <ion-menu-button autoHide="false"></ion-menu-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-row>
  <ion-col>
    <ion-button class="fill-button" expand="block" size="large" (click)="totalCalendarInfo()"> Calendar Stats</ion-button>
  </ion-col>
  <ion-col>
    <ion-button class="fill-button" expand="block" size="large" (click)="userInformation()"> Individual User Stats</ion-button>
  </ion-col>
  <ion-col>
    <ion-button class="fill-button" expand="block" size="large" (click)="showAdmins()"> ________ Stats </ion-button>
  </ion-col>
</ion-row>


<ion-content>
  <ion-content>
    <div class="ion-padding">


      <div *ngIf="calendarView">

        <ion-card>
          Total Calendar UserViews: {{calendarHolder}}
        </ion-card>
        <ion-card>
          Total Average Vists Per Session: {{calendarAverage}}
        </ion-card>
        <ion-item>
          <ion-label>
            From Date
          </ion-label>
          <ion-datetime displayFormat= "MM/DD/YYYY" [(ngModel)]= "startDate"></ion-datetime>
        </ion-item>
        <ion-item>
          <ion-label>
            To Date
          </ion-label>
          <ion-datetime displayFormat= "MM/DD/YYYY" [(ngModel)]= "endDate"></ion-datetime>
        </ion-item>

        <ion-card>
          <ion-card-header>
            Calendar Visits
          </ion-card-header>
          <ion-card-content>
            <canvas #lineChart></canvas>
          </ion-card-content>
        </ion-card>

      </div>




      <div *ngIf="indivUserView">
        <ion-item>
          <ion-label position = "floating" > User ID</ion-label>
          <ion-input type = "text" [(ngModel)] = "USERID" id="input"></ion-input>
        </ion-item>
        <ion-button (click)= "getUserSessions()"  (click) = "getUserTime()" (click)= "getUserTotalClicks()" padding = "100" type='button'>
          submit
        </ion-button>
      </div>



      <ion-item *ngFor= "let session of (sessions| async)" >
        <ion-card>

          <div class = "LoginTime">
            LoginTime: {{ session.LoginTime.seconds * 1000 | date:'MM-dd-yyyy h:mm a'}}
          </div>
          <div>
            LogOutTime: {{ session.LogOutTime.seconds * 1000 | date:'MM-dd-yyyy h:mm a'}}
          </div>
          <div>
            UserID: {{ session.userID }}
          </div>
        </ion-card>
      </ion-item>



      <ion-item *ngFor= "let items of durationArray" >

          <ion-grid>
            <ion-row>
              <ion-col>
                <div >
                  Page: {{ items.Page }}
                </div>
              </ion-col>
              <ion-col>
                <div>
                  Minutes: {{ items.Time}}
                </div>
              </ion-col>
            </ion-row>
          </ion-grid>
      </ion-item>






      <ion-item *ngFor= "let analytic of (analytics | async)" >
        <ion-grid>
          <ion-row>
            <ion-col>
              <div >
                User: {{ analytic.userID }}
              </div>
            </ion-col>
            <ion-col>
              <div>
                Time Stamp: {{ analytic.timestamp.seconds * 1000 | date:'MM-dd-yyyy h:mm a'}}
              </div>
            </ion-col>
            <ion-col>
              <div>
                Session ID: {{ analytic.sessionID }}
              </div>
            </ion-col>
            <ion-col>
              <div>
                Page: {{ analytic.page }}
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>

      <ion-item *ngFor= "let unqiueSession of (uniqueSessions | async)" >

        <ion-grid>
          <ion-row>
            <ion-col>
              <div class = "LoginTime">
                User: {{ unqiueSession.userID }}
              </div>
            </ion-col>
            <ion-col>
              <div>
                Time Stamp: {{ unqiueSession.timestamp.seconds * 1000 | date:'MM-dd-yyyy h:mm a' }}
              </div>
            </ion-col>
            <ion-col>
              <div>
                Session ID: {{ unqiueSession.sessionID }}
              </div>
            </ion-col>
            <ion-col>
              <div>
                Page: {{ unqiueSession.page }}
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>

      </ion-item>
    </div>
  </ion-content>
